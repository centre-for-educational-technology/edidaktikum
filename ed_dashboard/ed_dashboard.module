<?php

/**
 * @file
 * eDidaktikum dashboard module.
 */

/**
 * Implements hook_menu().
 */
function ed_dashboard_menu() {
  $items['dashboard'] = array(
    'title' => t('Dashboard'),
    'page callback' => 'ed_dashboard_page',
    'access callback' => 'user_is_logged_in',
    'weight' => -5,
    'menu_name' => 'main-menu',
    'type' => MENU_NORMAL_ITEM,
  );
  $items['dashboard/home'] = array(
    'title' => t('Dashboard'),
    'page callback' => 'ed_dashboard_page',
    'access callback' => 'user_is_logged_in',
    'weight' => 0,
    'menu_name' => 'ed-dashboard-menu',
    'type' => MENU_NORMAL_ITEM,
  );
  return $items;
}

/**
 * Dashboard page.
 */
function ed_dashboard_page() {
  menu_tree_set_path('main-menu', 'dashboard');
 
  $content = array();

  $og_user_groups = og_get_groups_by_user();
  if (!empty($og_user_groups['node'])) {
    $groups = node_load_multiple($og_user_groups['node']);
  }

  if (!empty($groups)) {
    $content['groups-listing'] = node_view_multiple($groups, 'dashboard');
    $content['groups-listing']['pager'] = array(
      '#theme' => 'pager',
      '#weight' => 5,
    );
  }
 
  return $content; 
}

